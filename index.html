<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Block-wise Adaptive Caching for Accelerating Diffusion Policy</title>
    
    <!-- 1. Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Castoro:ital@0;1&family=Inter:wght@300;400;500;600;800&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- 3. Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- GLOBAL STYLES --- */
        body {
            background-color: #f8f9fa; 
            scroll-behavior: smooth;
        }
        
        /* --- NEW ADVANCED BUTTONS --- */
        .btn-modern-primary {
            position: relative;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.85rem 2rem;
            font-size: 1.05rem;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            border-radius: 9999px;
            box-shadow: 
                0 4px 6px -1px rgba(15, 23, 42, 0.2), 
                0 10px 15px -3px rgba(15, 23, 42, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1); 
            border: 1px solid rgba(255,255,255,0.05);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
            letter-spacing: 0.01em;
        }

        .btn-modern-primary::before {
            content: '';
            position: absolute;
            top: 0; left: -100%;
            width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s;
        }

        .btn-modern-primary:hover {
            transform: translateY(-2px);
            box-shadow: 
                0 20px 25px -5px rgba(15, 23, 42, 0.4), 
                0 8px 10px -6px rgba(15, 23, 42, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .btn-modern-primary:hover::before {
            left: 100%;
        }
        
        .btn-modern-primary i {
            transition: transform 0.3s ease;
        }
        .btn-modern-primary:hover i {
            transform: translateY(-2px);
        }

        .btn-modern-secondary {
            position: relative;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.85rem 2rem;
            font-size: 1.05rem;
            font-weight: 600;
            color: #334155;
            background: white;
            border-radius: 9999px;
            border: 1px solid #e2e8f0;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.05);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .btn-modern-secondary:hover {
            color: #0f172a;
            border-color: #cbd5e1;
            transform: translateY(-2px);
            background: #f8fafc;
            box-shadow: 
                0 10px 15px -3px rgba(0, 0, 0, 0.05),
                0 4px 6px -2px rgba(0, 0, 0, 0.025);
        }
        
        .btn-modern-secondary i {
            color: #64748b;
            transition: color 0.2s;
        }
        .btn-modern-secondary:hover i {
            color: #0f172a;
        }

        /* --- LEGACY SECTION STYLES --- */
        .legacy-section {
            font-family: 'Roboto', sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .section-box {
            background: white;
            padding: 30px;
            margin-bottom: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            font-family: 'Inter', sans-serif;
        }

        .legacy-section h2 {
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 20px;
            color: #333;
            font-size: 1.5em;
            font-weight: 700;
            font-family: 'Roboto', sans-serif;
        }

        .legacy-section h3 {
            font-size: 1.17em;
            font-weight: 700;
            margin-bottom: 15px;
            color: #333;
            font-family: 'Roboto', sans-serif;
        }

        .abstract-text { text-align: justify; font-size: 1.1em; font-family: 'Roboto', sans-serif; line-height: 1.7; }
        .highlight-list {
            margin-top: 30px !important; 
            list-style: none !important; 
            padding-left: 0 !important;
            display: grid !important; 
            grid-template-columns: repeat(3, 1fr) !important;
            gap: 24px !important;
            background: transparent !important;
            padding: 0 !important; 
            border-radius: 0 !important;
            border: none !important;
        }
        .highlight-list li { 
            font-weight: 400 !important; 
            color: #64748b !important; 
            display: block !important; 
            line-height: 1.6 !important;
            background: white !important;
            padding: 28px 24px !important;
            border-radius: 12px !important;
            border: 1px solid #e2e8f0 !important;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05) !important;
            transition: all 0.3s ease !important;
            text-align: left !important;
        }
        .highlight-list li:hover {
            transform: translateY(-3px) !important;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.08) !important;
            border-color: #cbd5e1 !important;
        }
        .highlight-list li .feature-header {
            display: flex !important;
            align-items: center !important;
            gap: 10px !important;
            margin-bottom: 10px !important;
        }
        .highlight-list li .emoji {
            font-size: 1.8em !important;
            line-height: 1 !important;
            flex-shrink: 0 !important;
        }
        .highlight-list li strong {
            color: #1e293b !important;
            font-weight: 600 !important;
            font-size: 1.05em !important;
        }
        .highlight-list li .feature-desc {
            color: #64748b !important;
            line-height: 1.6 !important;
        }

        .setup-container { display: flex; flex-direction: column; gap: 30px; }
        .setup-images-row { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; width: 100%; }
        .setup-image-item img {
            width: 100%; height: auto; max-height: 450px; object-fit: cover;
            border-radius: 4px; border: 1px solid #ddd; box-shadow: 0 2px 5px rgba(0,0,0,0.1); display: block; margin: 0 auto;
        }
        .setup-caption { font-size: 0.95em; color: #555; margin-top: 10px; font-weight: 500; text-align: center; }
        .specs-list { list-style: none; padding: 0; display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 10px; }
        .specs-list li { margin-bottom: 5px; padding-left: 20px; position: relative; }
        .specs-list li::before { content: "â€¢"; color: #007bff; font-weight: bold; position: absolute; left: 0; }

        .video-grid-modern { display: grid; grid-template-columns: repeat(1, minmax(0, 1fr)); gap: 2rem; }
        @media (min-width: 768px) { .video-grid-modern { grid-template-columns: repeat(2, minmax(0, 1fr)); } }
        .video-card-modern {
            background: #fff; border-radius: 12px; overflow: hidden; border: 1px solid #e5e7eb;
            transition: all 0.3s ease; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
        }
        .video-card-modern:hover { transform: translateY(-3px); box-shadow: 0 8px 16px rgba(0, 0, 0, 0.08); }
        .card-highlight { 
            border: 2px solid #7c9fd8; 
            background: linear-gradient(135deg, #f8fbff 0%, #f0f6ff 100%); 
            position: relative; 
        }
        .card-badge {
            position: absolute; top: 12px; right: 12px; 
            background: linear-gradient(135deg, #7c9fd8 0%, #6b8ec7 100%);
            color: white;
            padding: 5px 14px; border-radius: 9999px; 
            font-size: 0.7rem; font-weight: 700; 
            z-index: 10;
            box-shadow: 0 2px 6px rgba(107, 142, 199, 0.3);
        }

        /* --- VIZ STYLES --- */
        .viz-grid-container {
            display: grid;
            grid-template-columns: repeat(16, 1fr);
            gap: 5px;
            padding: 12px;
            background: linear-gradient(135deg, #fafbfc 0%, #f0f4f8 100%);
            border-radius: 8px;
            box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.03);
        }
        
        .block-cell {
            aspect-ratio: 1 / 1;
            border-radius: 4px;
            transition: all 0.25s ease;
            position: relative;
        }
        
        .block-cache { 
            background: linear-gradient(135deg, #ffffff 0%, #f1f5f9 100%);
            border: 1px solid #e2e8f0;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.03);
        }
        .block-update { 
            background: linear-gradient(135deg, #7c9fd8 0%, #6b8ec7 100%);
            border: 1px solid #5a7db6;
            transform: scale(1.04);
            box-shadow: 0 2px 6px rgba(107, 142, 199, 0.25);
            z-index: 5;
        }
        .block-error { 
            background: linear-gradient(135deg, #ffd4d4 0%, #ffb8b8 100%);
            border: 1.5px solid #ff9999;
            position: relative;
            animation: pulse-error 2s ease-in-out infinite;
        }
        .block-corrected { 
            background: linear-gradient(135deg, #a8e6cf 0%, #8dd4b5 100%);
            border: 1.5px solid #6ec49f;
            box-shadow: 0 0 8px rgba(141, 212, 181, 0.35);
            z-index: 10;
            /* Ensure bubbles are visible outside the cell if they float high */
            overflow: visible; 
        }
        
        @keyframes pulse-error {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.85; }
        }

        /* --- IMPROVED BUBBLE ANIMATION --- */
        
        /* 1. Define the bubble float animation with variable destination */
        @keyframes bubble-rise-wobble {
            0% { 
                transform: translate(-50%, -50%) scale(0.2); 
                opacity: 0; 
                bottom: 30%; /* Start slightly inside */
                margin-left: 0px;
            }
            20% {
                opacity: 0.9;
                transform: translate(-50%, -50%) scale(1); 
            }
            50% {
                opacity: 0.8;
                /* Add a slight wobble in the middle */
                margin-left: calc(var(--wobble-dir) * 5px); 
            }
            100% { 
                /* Move Up and Randomly Left/Right */
                bottom: 140%; 
                margin-left: calc(var(--tx) * 1px);
                transform: translate(-50%, -50%) scale(var(--scale-end)); 
                opacity: 0; 
            }
        }
        
        .bubble {
            position: absolute;
            left: 50%; /* Centered horizontally relative to parent */
            bottom: 30%; /* Starting position */
            
            /* Glassy / Shiny look */
            width: var(--size); 
            height: var(--size);
            border-radius: 50%;
            
            /* Realistic Bubble Gradient: Transparent center, white shiny rim */
            background: radial-gradient(
                circle at 30% 30%, 
                rgba(255, 255, 255, 0.95) 0%, 
                rgba(255, 255, 255, 0.5) 20%, 
                rgba(168, 230, 207, 0.4) 60%, 
                rgba(168, 230, 207, 0.1) 100%
            );
            
            /* Subtle border and shadow for depth */
            border: 0.5px solid rgba(255, 255, 255, 0.6);
            box-shadow: 
                0 0 2px rgba(255, 255, 255, 0.5),
                inset 0 0 4px rgba(255, 255, 255, 0.2);

            pointer-events: none;
            z-index: 20;
            
            /* Use CSS Variables for random behavior */
            animation: bubble-rise-wobble var(--dur) ease-out forwards;
            animation-delay: var(--delay);
        }

        .status-box {
            display: flex; justify-content: space-between; align-items: center;
            padding: 12px 16px; border-radius: 8px; margin-bottom: 10px;
            font-size: 0.85rem; font-weight: 600;
            transition: all 0.2s ease;
        }
        .status-box-success { 
            background: linear-gradient(135deg, #f0f9f4 0%, #e3f5e9 100%);
            border: 1px solid #c3e6cb;
            color: #2d6a4f;
            box-shadow: 0 1px 3px rgba(45, 106, 79, 0.08);
        }
        .status-box-fail { 
            background: linear-gradient(135deg, #fff5f5 0%, #ffe8e8 100%);
            border: 1px solid #ffd4d4;
            color: #b85450;
            box-shadow: 0 1px 3px rgba(184, 84, 80, 0.08);
        }

    </style>
</head>
<body class="antialiased text-slate-800">

    <!-- === HEADER === -->
    <nav class="sticky top-0 z-50 bg-white/90 backdrop-blur-md border-b border-slate-200 font-sans">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <span class="text-xl font-bold tracking-tight text-slate-900">BAC <span class="text-slate-400 font-normal">| Project Page</span></span>
                </div>
                <div class="hidden md:flex space-x-8 items-center">
                    <a href="#abstract" class="text-slate-600 hover:text-slate-800 transition-colors font-medium">Abstract</a>
                    <a href="#method" class="text-slate-600 hover:text-slate-800 transition-colors font-medium">Method</a>
                    <a href="#setup" class="text-slate-600 hover:text-slate-800 transition-colors font-medium">Experiments</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="bg-white pt-16 pb-12 sm:pt-24 sm:pb-16 border-b border-slate-100 font-sans">
        <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h1 class="text-4xl tracking-tight font-extrabold text-slate-900 sm:text-5xl md:text-6xl mb-6">
                <span class="block">Block-wise Adaptive Caching</span>
                <span class="block text-3xl sm:text-4xl text-slate-500 mt-2">for Accelerating Diffusion Policy</span>
            </h1>
            <div class="mt-2 text-sm font-semibold uppercase tracking-wide" style="color: #6b8ec7;">Under Review at ICLR 2026</div>
            
            <div class="mt-12 flex justify-center gap-5 flex-wrap">
                <a href="https://openreview.net/pdf?id=c6ZWfQLOWD" target="_blank" class="btn-modern-primary group">
                    <i class="fa-solid fa-file-pdf mr-3 text-lg"></i> 
                    <span>Read Paper</span>
                </a>
                <a href="https://anonymous.4open.science/r/Block-wise_Adaptive_Caching-1265" target="_blank" class="btn-modern-secondary group">
                    <i class="fa-brands fa-github mr-3 text-xl"></i> 
                    <span>View Code</span>
                </a>
            </div>
        </div>
    </div>

    <!-- === ABSTRACT === -->
    <div id="abstract" class="legacy-section pt-10">
        <div class="section-box">
            <h2>Abstract</h2>
            <div class="abstract-text">
                <p style="margin-bottom: 15px;">
                    <strong>Diffusion Policy</strong> has revolutionized robotic control with its ability to model complex multimodal distributions, yet its slow inference speed remains a critical bottleneck for real-time deployment.
                </p>
                <p>
                    We introduce <strong>Block-wise Adaptive Caching (BAC)</strong>, a <em>training-free</em> acceleration framework designed specifically for Transformer-based Diffusion Policies. Unlike generic acceleration methods, BAC leverages the unique temporal redundancy of action features in robotic tasks. By adaptively caching and reusing features at the block level, BAC achieves <strong>lossless acceleration</strong>â€”enabling your robot to react faster and smoother for free!
                </p>
                <ul class="highlight-list">
                    <li>
                        <div class="feature-header">
                            <span class="emoji">ðŸš€</span>
                            <strong>Real-world Speedup</strong>
                        </div>
                        <div class="feature-desc">Boosts inference frequency from 8Hz â†’ 45Hz for smooth control.</div>
                    </li>
                    <li>
                        <div class="feature-header">
                            <span class="emoji">ðŸŽ¯</span>
                            <strong>Lossless Performance</strong>
                        </div>
                        <div class="feature-desc">Maintains high success rates via fine-grained adaptive caching.</div>
                    </li>
                    <li>
                        <div class="feature-header">
                            <span class="emoji">ðŸ”Œ</span>
                            <strong>Plug-and-Play Design</strong>
                        </div>
                        <div class="feature-desc">Just plug in one line of code without requiring any re-training.</div>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <!-- === METHODOLOGY (Compact Layout) === -->
    <div id="method" class="legacy-section">
        <div class="section-box">
            <h2>Methodology</h2>
            
            <p class="mb-6 abstract-text">
                BAC achieves a finer-grained cache schedule by first applying the <strong>Adaptive Caching Scheduler (ACS)</strong> to compute optimal update timesteps for each block and then employing the <strong>Bubbling Union Algorithm (BUA)</strong> to truncate inter-block error propagation.
            </p>

            <!-- Interactive Container -->
            <div class="bg-white rounded-xl border border-slate-200 overflow-hidden mb-8 shadow-sm">
                
                <!-- Controls -->
                <div class="p-4 border-b border-slate-100 flex flex-col md:flex-row justify-between items-center gap-4" style="background: linear-gradient(135deg, #fafbfc 0%, #f5f7fa 100%);">
                    <h3 class="!mb-0 !text-sm font-bold text-slate-700 uppercase tracking-wider pl-2">
                        <i class="fa-solid fa-sliders mr-2 text-slate-500"></i>Interactive Demo
                    </h3>
                    <div class="flex bg-white rounded-lg p-1.5 border border-slate-200 shadow-sm">
                        <button onclick="runSimulation('uniform')" id="btn-uniform" class="px-5 py-2 rounded-md text-sm font-semibold transition-all hover:bg-slate-50 text-slate-600">Uniform</button>
                        <button onclick="runSimulation('acs')" id="btn-acs" class="px-5 py-2 rounded-md text-sm font-semibold transition-all hover:bg-slate-50 text-slate-600">ACS</button>
                        <button onclick="runSimulation('bac')" id="btn-bac" class="px-5 py-2 rounded-md text-sm font-semibold transition-all bg-gradient-to-r from-slate-600 to-slate-500 text-white shadow-md">ACS + BUA</button>
                    </div>
                </div>
                
                <!-- Main Content (Tight Grid) -->
                <div class="p-4 grid grid-cols-1 lg:grid-cols-12 gap-4">
                    
                    <!-- LEFT: Grid (9 cols) -->
                    <div class="lg:col-span-9 relative">
                        <div class="flex justify-between text-xs font-semibold text-slate-400 mb-2 px-1 uppercase tracking-wide">
                            <span>Blocks <i class="fa-solid fa-arrow-down ml-1"></i></span>
                            <span>Timesteps <i class="fa-solid fa-arrow-right ml-1"></i></span>
                        </div>
                        <div id="viz-grid" class="viz-grid-container">
                            <!-- JS fills this -->
                        </div>
                    </div>
                    
                    <!-- RIGHT: Panel (3 cols) - Packed Content -->
                    <div class="lg:col-span-3 flex flex-col">
                        <div class="bg-white rounded-lg p-4 border border-slate-100 shadow-sm h-full flex flex-col">
                            <div class="mb-4">
                                <h4 id="viz-title" class="!text-lg font-bold text-slate-800 leading-tight">ACS + BUA</h4>
                                <p id="viz-desc" class="text-xs font-bold text-slate-500 mt-1 italic">Bubbling Union Algorithm</p>
                            </div>
                            
                            <!-- Badges -->
                            <div id="viz-analysis" class="space-y-2 mb-4"></div>
                            
                            <!-- Legend (Moved Here!) -->
                            <div class="mt-auto border-t border-slate-100 pt-3">
                                <p class="text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-3">Legend</p>
                                <div class="grid grid-cols-1 gap-2.5 text-xs font-medium text-slate-700">
                                    <div class="flex items-center">
                                        <div class="w-4 h-4 rounded mr-2.5 border border-slate-400" style="background: linear-gradient(135deg, #7c9fd8 0%, #6b8ec7 100%);"></div>
                                        <span>Updated Features</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-4 h-4 rounded mr-2.5 border border-slate-300" style="background: linear-gradient(135deg, #ffffff 0%, #f1f5f9 100%);"></div>
                                        <span>Cached Features</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-4 h-4 border border-red-300 rounded mr-2.5" style="background: linear-gradient(135deg, #ffd4d4 0%, #ffb8b8 100%);"></div>
                                        <span>Error Surge</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-4 h-4 border border-green-400 rounded mr-2.5" style="background: linear-gradient(135deg, #a8e6cf 0%, #8dd4b5 100%);"></div>
                                        <span>Error Correction</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- === EXPERIMENTS === -->
    <div id="setup" class="legacy-section pb-10">
        <div class="section-box">
            <h2>Experimental Setup</h2>
            <div class="setup-container">
                <div class="setup-images-row">
                    <div class="setup-image-item">
                        <img src="images/front_view.jpg" onerror="this.src='https://via.placeholder.com/500x350?text=Front+View+Image'" alt="Front view">
                        <p class="setup-caption">Front view</p>
                    </div>
                    <div class="setup-image-item">
                        <img src="images/side_view.jpg" onerror="this.src='https://via.placeholder.com/500x350?text=Side+View+Image'" alt="Side view">
                        <p class="setup-caption">Side view</p>
                    </div>
                </div>

                <div class="setup-info">
                    <h3>Task Description</h3>
                    <p style="margin-bottom: 20px; line-height: 1.7;">
                        We evaluate our method on the Pick-and-Release task in a real-world setting. In this task, the robot is required to grasp a soft bag whose diameter is approximately 80% of the gripper's jaw width. This scenario poses a challenge to the robot's real-time manipulation capabilities, particularly in maintaining a stable operating posture and precisely coordinating the timing of the gripper's opening and closing in high speed, as the bag is prone to toppling during execution.
                    </p>
                </div>

                <div class="setup-info">
                    <h3>Hardware Setup</h3>
                    <ul class="specs-list">
                        <li><strong>Robot Arm:</strong> Franka Research 3</li>
                        <li><strong>Camera:</strong> UGREEN CM717</li>
                        <li><strong>GPU:</strong> NVIDIA GeForce RTX 4090D</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="section-box">
            <h2>Qualitative Comparisons</h2>
            <p style="margin-bottom: 25px; line-height: 1.7;">
                Comparisons of different acceleration methods on the Pick-and-Release task. <span style="color: #6b8ec7; font-weight: 600;">BAC achieves high inference frequency with low end-to-end latency.</span>
            </p>
            
            <div class="video-grid-modern">
                <!-- Video 1 -->
                <div class="video-card-modern">
                    <video autoplay loop muted playsinline controls style="border-radius: 12px 12px 0 0;"><source src="videos/DP-s.mp4" type="video/mp4"></video>
                    <div class="p-5 bg-white">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-base font-bold text-slate-800 m-0">DDPM 100 steps</h4>
                            <span class="text-xs px-3 py-1 rounded-full font-semibold" style="background: linear-gradient(135deg, #ffe8e8 0%, #ffd4d4 100%); color: #b85450;">Failure</span>
                        </div>
                        <div class="space-y-2.5">
                            <div class="flex justify-between text-sm text-slate-600"><span class="font-medium">Frequency</span> <span class="font-mono text-slate-900 font-semibold">7.8 Hz</span></div>
                            <div class="w-full bg-slate-100 rounded-full h-2 overflow-hidden"><div class="bg-gradient-to-r from-slate-300 to-slate-400 h-2 rounded-full transition-all" style="width: 17%"></div></div>
                            <div class="flex justify-between text-sm text-slate-600"><span class="font-medium">Latency</span> <span class="font-mono text-slate-900 font-semibold">180 s</span></div>
                             <div class="w-full bg-slate-100 rounded-full h-2 overflow-hidden"><div class="bg-gradient-to-r from-red-300 to-red-400 h-2 rounded-full transition-all" style="width: 100%"></div></div>
                        </div>
                    </div>
                </div>
                 <!-- Video 2 -->
                <div class="video-card-modern">
                    <video autoplay loop muted playsinline controls style="border-radius: 12px 12px 0 0;"><source src="videos/DDPM30-s.mp4" type="video/mp4"></video>
                    <div class="p-5 bg-white">
                        <div class="flex justify-between items-center mb-3"><h4 class="text-base font-bold text-slate-800 m-0">DDPM 30 steps</h4></div>
                        <div class="space-y-2.5">
                            <div class="flex justify-between text-sm text-slate-600"><span class="font-medium">Frequency</span> <span class="font-mono text-slate-900 font-semibold">19.4 Hz</span></div>
                            <div class="w-full bg-slate-100 rounded-full h-2 overflow-hidden"><div class="bg-gradient-to-r from-slate-300 to-slate-400 h-2 rounded-full transition-all" style="width: 43%"></div></div>
                            <div class="flex justify-between text-sm text-slate-600"><span class="font-medium">Latency</span> <span class="font-mono text-slate-900 font-semibold">54 s</span></div>
                             <div class="w-full bg-slate-100 rounded-full h-2 overflow-hidden"><div class="bg-gradient-to-r from-slate-300 to-slate-400 h-2 rounded-full transition-all" style="width: 30%"></div></div>
                        </div>
                    </div>
                </div>
                 <!-- Video 3 -->
                <div class="video-card-modern">
                    <video autoplay loop muted playsinline controls style="border-radius: 12px 12px 0 0;"><source src="videos/DDIM50-s.mp4" type="video/mp4"></video>
                    <div class="p-5 bg-white">
                        <div class="flex justify-between items-center mb-3"><h4 class="text-base font-bold text-slate-800 m-0">DDIM 50 steps</h4></div>
                        <div class="space-y-2.5">
                            <div class="flex justify-between text-sm text-slate-600"><span class="font-medium">Frequency</span> <span class="font-mono text-slate-900 font-semibold">15.6 Hz</span></div>
                            <div class="w-full bg-slate-100 rounded-full h-2 overflow-hidden"><div class="bg-gradient-to-r from-slate-300 to-slate-400 h-2 rounded-full transition-all" style="width: 34%"></div></div>
                            <div class="flex justify-between text-sm text-slate-600"><span class="font-medium">Latency</span> <span class="font-mono text-slate-900 font-semibold">25 s</span></div>
                            <div class="w-full bg-slate-100 rounded-full h-2 overflow-hidden"><div class="bg-gradient-to-r from-slate-300 to-slate-400 h-2 rounded-full transition-all" style="width: 14%"></div></div>
                        </div>
                    </div>
                </div>
                <!-- Video 4 -->
                <div class="video-card-modern">
                    <video autoplay loop muted playsinline controls style="border-radius: 12px 12px 0 0;"><source src="videos/Uniform20-s.mp4" type="video/mp4"></video>
                    <div class="p-5 bg-white">
                        <div class="flex justify-between items-center mb-3"><h4 class="text-base font-bold text-slate-800 m-0">Uniform S=20</h4></div>
                        <div class="space-y-2.5">
                            <div class="flex justify-between text-sm text-slate-600"><span class="font-medium">Frequency</span> <span class="font-mono text-slate-900 font-semibold">28.1 Hz</span></div>
                            <div class="w-full bg-slate-100 rounded-full h-2 overflow-hidden"><div class="bg-gradient-to-r from-slate-300 to-slate-400 h-2 rounded-full transition-all" style="width: 62%"></div></div>
                            <div class="flex justify-between text-sm text-slate-600"><span class="font-medium">Latency</span> <span class="font-mono text-slate-900 font-semibold">52 s</span></div>
                            <div class="w-full bg-slate-100 rounded-full h-2 overflow-hidden"><div class="bg-gradient-to-r from-slate-300 to-slate-400 h-2 rounded-full transition-all" style="width: 28%"></div></div>
                        </div>
                    </div>
                </div>
                 <!-- Video 5 -->
                <div class="video-card-modern card-highlight">
                    <div class="card-badge">Ours</div>
                    <video autoplay loop muted playsinline controls style="border-radius: 12px 12px 0 0;"><source src="videos/BAC-s.mp4" type="video/mp4"></video>
                    <div class="p-5 bg-white/80">
                        <div class="flex justify-between items-center mb-3"><h4 class="text-base font-bold m-0" style="color: #6b8ec7;">BAC S=7</h4></div>
                        <div class="space-y-2.5">
                            <div class="flex justify-between text-sm text-slate-600"><span class="font-medium">Frequency</span> <span class="font-mono text-slate-900 font-semibold">39.2 Hz</span></div>
                            <div class="w-full bg-slate-200 rounded-full h-2 overflow-hidden"><div class="bg-gradient-to-r from-blue-400 to-blue-500 h-2 rounded-full transition-all" style="width: 87%"></div></div>
                            <div class="flex justify-between text-sm text-slate-600"><span class="font-medium">Latency</span> <span class="font-mono text-slate-900 font-semibold">15 s</span></div>
                            <div class="w-full bg-slate-200 rounded-full h-2 overflow-hidden"><div class="bg-gradient-to-r from-blue-400 to-blue-500 h-2 rounded-full transition-all" style="width: 8%"></div></div>
                        </div>
                    </div>
                </div>
                 <!-- Video 6 -->
                <div class="video-card-modern card-highlight">
                    <div class="card-badge">Ours (Fastest)</div>
                    <video autoplay loop muted playsinline controls style="border-radius: 12px 12px 0 0;"><source src="videos/BAC5-s.mp4" type="video/mp4"></video>
                    <div class="p-5 bg-white/80">
                        <div class="flex justify-between items-center mb-3"><h4 class="text-base font-bold m-0" style="color: #6b8ec7;">BAC S=5</h4></div>
                        <div class="space-y-2.5">
                            <div class="flex justify-between text-sm text-slate-600"><span class="font-medium">Frequency</span> <span class="font-mono text-slate-900 font-semibold">45.1 Hz</span></div>
                            <div class="w-full bg-slate-200 rounded-full h-2 overflow-hidden"><div class="bg-gradient-to-r from-blue-400 to-blue-500 h-2 rounded-full transition-all" style="width: 100%"></div></div>
                            <div class="flex justify-between text-sm text-slate-600"><span class="font-medium">Latency</span> <span class="font-mono text-slate-900 font-semibold">13 s</span></div>
                            <div class="w-full bg-slate-200 rounded-full h-2 overflow-hidden"><div class="bg-gradient-to-r from-blue-400 to-blue-500 h-2 rounded-full transition-all" style="width: 7%"></div></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- === FOOTER === -->
    <footer class="py-8 bg-slate-50 border-t border-slate-200 font-sans text-center text-slate-400 text-sm">
        <p>Project page template.</p>
    </footer>

    <!-- Scripts -->
    <script>
        const grid = document.getElementById('viz-grid');
        const rows = 8; const cols = 16;
        let animationInterval = null;

        function createGrid() {
            grid.innerHTML = '';
            for (let r = 0; r < rows; r++) {
                for (let c = 0; c < cols; c++) {
                    const cell = document.createElement('div');
                    cell.className = `block-cell block-cache`;
                    cell.id = `cell-${r}-${c}`;
                    grid.appendChild(cell);
                }
            }
        }

        /* --- IMPROVED BUBBLE LOGIC --- */
        function triggerBubbles(r, c) {
            const cell = document.getElementById(`cell-${r}-${c}`);
            if (!cell) return;
            
            // Increase number of bubbles for more visible effect (5 to 8)
            const count = 5 + Math.floor(Math.random() * 4);
            
            for (let i = 0; i < count; i++) {
                const bubble = document.createElement('div');
                bubble.className = 'bubble';
                
                // Randomize Size
                const size = 6 + Math.random() * 8; // 6px to 14px
                bubble.style.setProperty('--size', `${size}px`);
                
                // Randomize Horizontal Destination (Wobble Amplitude)
                // Negative = Left, Positive = Right
                const tx = (Math.random() - 0.5) * 40; 
                bubble.style.setProperty('--tx', tx);
                
                // Randomize Wobble Direction (for the middle of animation)
                const wobbleDir = Math.random() > 0.5 ? 1 : -1;
                bubble.style.setProperty('--wobble-dir', wobbleDir);

                // Randomize Vertical End Scale (Pop effect)
                const scaleEnd = 0.8 + Math.random() * 0.5;
                bubble.style.setProperty('--scale-end', scaleEnd);
                
                // Randomize Duration and Delay
                const dur = 1 + Math.random() * 0.8; // 1s to 1.8s
                bubble.style.setProperty('--dur', `${dur}s`);
                
                const delay = Math.random() * 0.3;
                bubble.style.setProperty('--delay', `${delay}s`);
                
                // Randomize Start Position slightly from center
                const leftOffset = 50 + (Math.random() - 0.5) * 20; // 40% to 60%
                bubble.style.left = `${leftOffset}%`;

                cell.appendChild(bubble);
                
                // Cleanup
                setTimeout(() => bubble.remove(), dur * 1000 + 100);
            }
        }

        function setCell(r, c, type) {
            const cell = document.getElementById(`cell-${r}-${c}`);
            if (!cell) return;
            cell.className = 'block-cell block-cache';
            setTimeout(() => {
                if (type === 'update') {
                    cell.classList.remove('block-cache');
                    cell.classList.add('block-update');
                } else if (type === 'error') {
                    cell.classList.add('block-error');
                } else if (type === 'corrected') {
                    cell.classList.remove('block-cache');
                    cell.classList.add('block-corrected');
                }
            }, 0);
        }

        function clearGrid() {
            if (animationInterval) clearInterval(animationInterval);
            const cells = document.querySelectorAll('.block-cell');
            cells.forEach(c => {
                c.className = 'block-cell block-cache'; 
                c.innerHTML = ''; 
            });
        }

        function runSimulation(mode) {
            document.querySelectorAll('button[id^="btn-"]').forEach(b => {
                b.className = "px-5 py-2 rounded-md text-sm font-semibold transition-all hover:bg-slate-50 text-slate-600";
            });
            const activeBtn = document.getElementById(`btn-${mode}`);
            activeBtn.className = "px-5 py-2 rounded-md text-sm font-semibold transition-all bg-gradient-to-r from-slate-600 to-slate-500 text-white shadow-md";
            
            clearGrid();
            
            const title = document.getElementById('viz-title');
            const desc = document.getElementById('viz-desc');
            const analysis = document.getElementById('viz-analysis');
            
            let logic = (c, r) => false;
            let errorSteps = []; 
            
            if (mode === 'uniform') {
                title.innerText = "Uniform Caching";
                desc.innerText = "";
                analysis.innerHTML = `
                    <div class="status-box status-box-fail">
                        <span>Reduce Reuse-induced Error</span>
                        <i class="fa-solid fa-circle-xmark text-lg"></i>
                    </div>
                    <div class="status-box status-box-fail">
                        <span>Reduce Update-induced Error</span>
                        <i class="fa-solid fa-circle-xmark text-lg"></i>
                    </div>
                `;
                logic = (c, r) => c % 4 === 0;
            } else if (mode === 'acs') {
                title.innerText = "ACS";
                desc.innerText = "";
                analysis.innerHTML = `
                    <div class="status-box status-box-success">
                        <span>Reduce Reuse-induced Error</span>
                        <i class="fa-solid fa-circle-check text-lg"></i>
                    </div>
                    <div class="status-box status-box-fail">
                        <span>Reduce Update-induced Error</span>
                        <i class="fa-solid fa-circle-xmark text-lg"></i>
                    </div>
                `;
                logic = (c, r) => {
                    let freq = (r % 2 == 0) ? 3 : 5;
                    return (c + r) % freq == 0;
                };
                errorSteps = [5, 11]; 
            } else if (mode === 'bac') {
                title.innerText = "ACS + BUA";
                desc.innerText = "";
                analysis.innerHTML = `
                    <div class="status-box status-box-success">
                        <span>Reduce Reuse-induced Error</span>
                        <i class="fa-solid fa-circle-check text-lg"></i>
                    </div>
                    <div class="status-box status-box-success">
                        <span>Reduce Update-induced Error</span>
                        <i class="fa-solid fa-circle-check text-lg"></i>
                    </div>
                `;
                logic = (c, r) => {
                    let freq = (r % 2 == 0) ? 3 : 5;
                    return (c + r) % freq == 0;
                };
                errorSteps = [5, 11]; 
            }

            let currentStep = 0;
            animationInterval = setInterval(() => {
                if (currentStep >= cols) {
                    clearInterval(animationInterval);
                    return;
                }
                for (let r = 0; r < rows; r++) {
                    const isUpdate = logic(currentStep, r);
                    const isErrorStep = errorSteps.includes(currentStep);
                    if (mode === 'acs' && isErrorStep && r === 3) {
                         setCell(3, currentStep, 'error'); 
                         setCell(4, currentStep, 'update'); 
                    } else if (mode === 'bac' && isErrorStep && r === 3) {
                         setCell(3, currentStep, 'corrected'); 
                         triggerBubbles(3, currentStep); 
                         setCell(4, currentStep, 'update');
                    } else {
                        if (isUpdate) setCell(r, currentStep, 'update');
                    }
                }
                currentStep++;
            }, 150);
        }

        createGrid();
        setTimeout(() => runSimulation('bac'), 500);
    </script>
</body>
</html>